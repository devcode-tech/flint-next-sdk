{"version":3,"file":"security.js","sourceRoot":"","sources":["../../src/lib/security.ts"],"names":[],"mappings":"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","sourcesContent":["/**\r\n * Security utilities for the SDK\r\n */\r\n\r\n// Sanitize user input to prevent XSS attacks\r\nexport function sanitizeInput(input: string): string {\r\n  if (typeof input !== 'string') return '';\r\n  \r\n  return input\r\n    .replace(/&/g, '&amp;')\r\n    .replace(/</g, '&lt;')\r\n    .replace(/>/g, '&gt;')\r\n    .replace(/\"/g, '&quot;')\r\n    .replace(/'/g, '&#x27;')\r\n    .replace(/\\//g, '&#x2F;');\r\n}\r\n\r\n// Validate URL to prevent javascript: and data: URIs\r\nexport function sanitizeUrl(url: string): string {\r\n  if (typeof url !== 'string') return '';\r\n  \r\n  const trimmedUrl = url.trim().toLowerCase();\r\n  \r\n  // Block dangerous protocols\r\n  if (\r\n    trimmedUrl.startsWith('javascript:') ||\r\n    trimmedUrl.startsWith('data:') ||\r\n    trimmedUrl.startsWith('vbscript:') ||\r\n    trimmedUrl.startsWith('file:')\r\n  ) {\r\n    return '';\r\n  }\r\n  \r\n  return url;\r\n}\r\n\r\n// Content Security Policy helpers\r\nexport function setupCSP() {\r\n  const meta = document.createElement('meta');\r\n  meta.httpEquiv = 'Content-Security-Policy';\r\n  meta.content = [\r\n    \"default-src 'self'\",\r\n    \"script-src 'self' 'unsafe-inline' 'unsafe-eval'\", // Required for React\r\n    \"style-src 'self' 'unsafe-inline'\", // Required for inline styles\r\n    \"img-src 'self' data: https:\",\r\n    \"font-src 'self' data:\",\r\n    \"connect-src 'self' https:\",\r\n    \"frame-ancestors 'none'\"\r\n  ].join('; ');\r\n  \r\n  document.head.appendChild(meta);\r\n}\r\n\r\n// Validate form data\r\nexport function validateFormData(data: Record<string, any>): boolean {\r\n  // Check for prototype pollution\r\n  if ('__proto__' in data || 'constructor' in data || 'prototype' in data) {\r\n    console.error('Security: Potential prototype pollution detected');\r\n    return false;\r\n  }\r\n  \r\n  // Validate data size (prevent DoS)\r\n  const dataString = JSON.stringify(data);\r\n  const maxSize = 5 * 1024 * 1024; // 5MB limit\r\n  \r\n  if (dataString.length > maxSize) {\r\n    console.error('Security: Form data exceeds maximum size');\r\n    return false;\r\n  }\r\n  \r\n  return true;\r\n}\r\n\r\n// Rate limiting\r\nclass RateLimiter {\r\n  private attempts: Map<string, number[]> = new Map();\r\n  private readonly maxAttempts = 5;\r\n  private readonly windowMs = 60000; // 1 minute\r\n\r\n  isAllowed(key: string): boolean {\r\n    const now = Date.now();\r\n    const attempts = this.attempts.get(key) || [];\r\n    \r\n    // Remove old attempts outside the window\r\n    const recentAttempts = attempts.filter(time => now - time < this.windowMs);\r\n    \r\n    if (recentAttempts.length >= this.maxAttempts) {\r\n      return false;\r\n    }\r\n    \r\n    recentAttempts.push(now);\r\n    this.attempts.set(key, recentAttempts);\r\n    \r\n    return true;\r\n  }\r\n\r\n  reset(key: string) {\r\n    this.attempts.delete(key);\r\n  }\r\n}\r\n\r\nexport const rateLimiter = new RateLimiter();"]}